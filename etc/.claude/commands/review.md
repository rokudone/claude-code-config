# Claude コードレビューコマンド

## 目的
包括的なコードレビューを自律的に実行し、潜在的な問題を特定して改善案を提案する。

## 指示
このコマンドが実行される際、以下を行う：

1. **レビュー範囲の特定**
   - レビューが必要なファイルを決定（変更されたファイル、新規ファイル、または指定されたファイル）
   - 指定がない場合はgit statusとgit diffを使用して変更を特定
   - 特別な要求がない限り、ドキュメントよりもコードの変更に焦点を当てる

2. **レビューカテゴリ**
   各ファイルについて以下を分析：
   
   **コード品質**
   - ロジックエラーや潜在的なバグ
   - エッジケースの処理
   - エラーハンドリングとバリデーション
   - コードの重複
   - デッドコードや未使用変数
   
   **セキュリティ**
   - 潜在的なセキュリティ脆弱性
   - 入力検証の問題
   - 認証・認可の懸念事項
   - 機密データの露出
   - SQLインジェクション、XSS、その他のインジェクションリスク
   
   **パフォーマンス**
   - 非効率なアルゴリズムやデータ構造
   - N+1クエリ問題
   - メモリリークや過剰なメモリ使用
   - 不要な計算処理
   
   **保守性**
   - コードの明確性と可読性
   - 命名規則
   - 関数・メソッドの複雑さ
   - 適切な抽象化
   - ドキュメント化の必要性
   
   **ベストプラクティス**
   - 言語固有のイディオムと慣例
   - フレームワークのベストプラクティス
   - テストカバレッジの提案
   - デザインパターンの活用機会

3. **出力形式**
   レビューを以下のように構成：
   
   ```markdown
   # コードレビューレポート
   
   ## 概要
   [レビューしたファイルの簡潔な概要と全体的な評価]
   
   ## 重大な問題 🚨
   [進行前に修正が必要な問題]
   
   ## 重要な提案 ⚠️
   [強く推奨される改善点]
   
   ## 軽微な改善点 💡
   [あると良い拡張機能]
   
   ## 良い点 ✅
   [よく実装された機能や観察された良いプラクティス]
   
   ## ファイル別レビュー
   
   ### [ファイル名]
   - **問題**: [説明]
     - **場所**: [ファイル:行番号]
     - **重要度**: [重大/高/中/低]
     - **提案**: [修正方法]
   ```

4. **レビュープロセス**
   - 変更の文脈と目的を理解することから開始
   - 重要度順にレビュー：重大なセキュリティ・ロジック問題を最優先
   - 具体的な例を使用して実行可能なフィードバックを提供
   - 問題の特定だけでなく、具体的な改善案を提案
   - 批判と良いプラクティスの認識のバランスを取る

5. **特別な考慮事項**
   - 新機能：完全性とエッジケースを検証
   - リファクタリング：動作の保持を確認
   - バグ修正：修正が根本原因に対処していることを確認
   - パフォーマンス改善：最適化を検証

## 使用例
```
# すべての変更されたファイルをレビュー
/review

# 特定のファイルをレビュー
/review src/api/users.ts src/utils/validation.ts

# 焦点領域を指定してレビュー
/review --focus security
```

注意：徹底的であると同時に建設的であること。目標は開発者の生産性を維持しながらコード品質を向上させることである。